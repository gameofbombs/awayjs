"use strict";
var Sampler2D_1 = require("awayjs-core/lib/image/Sampler2D");
var URLLoaderEvent_1 = require("awayjs-core/lib/events/URLLoaderEvent");
var RequestAnimationFrame_1 = require("awayjs-core/lib/utils/RequestAnimationFrame");
var Debug_1 = require("awayjs-core/lib/utils/Debug");
var View_1 = require("awayjs-display/lib/View");
var PrimitivePlanePrefab_1 = require("awayjs-display/lib/prefabs/PrimitivePlanePrefab");
var DefaultRenderer_1 = require("awayjs-renderergl/lib/DefaultRenderer");
var BasicMaterial_1 = require("awayjs-display/lib/materials/BasicMaterial");
var URLLoader_1 = require("awayjs-core/lib/net/URLLoader");
var URLLoaderDataFormat_1 = require("awayjs-core/lib/net/URLLoaderDataFormat");
var URLRequest_1 = require("awayjs-core/lib/net/URLRequest");
var ParserUtils_1 = require("awayjs-core/lib/parsers/ParserUtils");
var ElementsType_1 = require("awayjs-display/lib/graphics/ElementsType");
var MipMapSoftwareTest = (function () {
    function MipMapSoftwareTest() {
        var _this = this;
        this.c = 100;
        var pngURLRequest = new URLRequest_1.URLRequest('assets/dots.png');
        this.pngLoader = new URLLoader_1.URLLoader();
        this.pngLoader.dataFormat = URLLoaderDataFormat_1.URLLoaderDataFormat.BLOB;
        this.pngLoader.addEventListener(URLLoaderEvent_1.URLLoaderEvent.LOAD_COMPLETE, function (event) { return _this.pngLoaderComplete(event); });
        this.pngLoader.load(pngURLRequest);
    }
    MipMapSoftwareTest.prototype.pngLoaderComplete = function (event) {
        var _this = this;
        var imageLoader = event.target;
        this.image = ParserUtils_1.ParserUtils.blobToImage(imageLoader.data);
        this.image.onload = function (event) { return _this.onLoadComplete(event); };
    };
    MipMapSoftwareTest.prototype.onLoadComplete = function (event) {
        var _this = this;
        Debug_1.Debug.LOG_PI_ERRORS = false;
        Debug_1.Debug.THROW_ERRORS = false;
        var defaultRenderer = new DefaultRenderer_1.DefaultRenderer(null, false, "baseline", "software");
        defaultRenderer.antiAlias = 2;
        this.view = new View_1.View(defaultRenderer);
        //this.view = new View(new DefaultRenderer(null, false, "baseline"));
        this.raf = new RequestAnimationFrame_1.RequestAnimationFrame(this.render, this);
        this.view.backgroundColor = 0x222222;
        window.onresize = function (event) { return _this.onResize(event); };
        this.initSpritees();
        this.raf.start();
        this.onResize();
    };
    MipMapSoftwareTest.prototype.initSpritees = function () {
        //var material:BasicMaterial = new BasicMaterial(DefaultMaterialManager.getDefaultTexture());
        var material = new BasicMaterial_1.BasicMaterial(ParserUtils_1.ParserUtils.imageToBitmapImage2D(this.image));
        material.style.sampler = new Sampler2D_1.Sampler2D(true, true, true);
        var plane = new PrimitivePlanePrefab_1.PrimitivePlanePrefab(material, ElementsType_1.ElementsType.TRIANGLE, 1000, 1000, 1000);
        //var plane:PrimitiveCubePrefab = new PrimitiveCubePrefab();
        plane.material = material;
        var sprite = plane.getNewObject();
        sprite.y = -100;
        this.view.scene.addChild(sprite);
    };
    MipMapSoftwareTest.prototype.render = function () {
        if (this.c > 10) {
            this.c = 0;
            this.view.render();
        }
        this.c++;
    };
    MipMapSoftwareTest.prototype.onResize = function (event) {
        if (event === void 0) { event = null; }
        this.view.y = 0;
        this.view.x = 0;
        this.view.width = window.innerWidth;
        this.view.height = window.innerHeight;
    };
    return MipMapSoftwareTest;
}());

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNvZnR3YXJlL01pcE1hcFNvZnR3YXJlVGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsMEJBQTRCLGlDQUFpQyxDQUFDLENBQUE7QUFDOUQsK0JBQWdDLHVDQUF1QyxDQUFDLENBQUE7QUFDeEUsc0NBQTJDLDZDQUE2QyxDQUFDLENBQUE7QUFDekYsc0JBQTJDLDZCQUE2QixDQUFDLENBQUE7QUFFekUscUJBQTJDLHlCQUF5QixDQUFDLENBQUE7QUFFckUscUNBQTJDLGlEQUFpRCxDQUFDLENBQUE7QUFFN0YsZ0NBQTJDLHVDQUF1QyxDQUFDLENBQUE7QUFFbkYsOEJBQTJDLDRDQUE0QyxDQUFDLENBQUE7QUFDeEYsMEJBQTRCLCtCQUErQixDQUFDLENBQUE7QUFDNUQsb0NBQW9DLHlDQUF5QyxDQUFDLENBQUE7QUFDOUUsMkJBQTZCLGdDQUFnQyxDQUFDLENBQUE7QUFDOUQsNEJBQThCLHFDQUFxQyxDQUFDLENBQUE7QUFDcEUsNkJBQTJDLDBDQUEwQyxDQUFDLENBQUE7QUFFdEY7SUFPQztRQVBELGlCQXdFQztRQWpCUSxNQUFDLEdBQVUsR0FBRyxDQUFDO1FBOUN0QixJQUFJLGFBQWEsR0FBYyxJQUFJLHVCQUFVLENBQUMsaUJBQWlCLENBQUMsQ0FBQztRQUVqRSxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUkscUJBQVMsRUFBRSxDQUFDO1FBQ2pDLElBQUksQ0FBQyxTQUFTLENBQUMsVUFBVSxHQUFHLHlDQUFtQixDQUFDLElBQUksQ0FBQztRQUNyRCxJQUFJLENBQUMsU0FBUyxDQUFDLGdCQUFnQixDQUFDLCtCQUFjLENBQUMsYUFBYSxFQUFFLFVBQUMsS0FBb0IsSUFBSyxPQUFBLEtBQUksQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsRUFBN0IsQ0FBNkIsQ0FBQyxDQUFDO1FBQ3ZILElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDO0lBQ3BDLENBQUM7SUFFTyw4Q0FBaUIsR0FBekIsVUFBMEIs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O1FBQ3BDLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQyxXQUFXLENBQUM7SUFDdkMsQ0FBQztJQUNGLHlCQUFDO0FBQUQsQ0F4RUEsQUF3RUMsSUFBQSIsImZpbGUiOiJzb2Z0d2FyZS9NaXBNYXBTb2Z0d2FyZVRlc3QuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1NhbXBsZXIyRH1cdFx0XHRcdFx0ZnJvbSBcImF3YXlqcy1jb3JlL2xpYi9pbWFnZS9TYW1wbGVyMkRcIjtcbmltcG9ydCB7VVJMTG9hZGVyRXZlbnR9XHRcdFx0XHRmcm9tIFwiYXdheWpzLWNvcmUvbGliL2V2ZW50cy9VUkxMb2FkZXJFdmVudFwiO1xuaW1wb3J0IHtSZXF1ZXN0QW5pbWF0aW9uRnJhbWV9ICAgICAgICBmcm9tIFwiYXdheWpzLWNvcmUvbGliL3V0aWxzL1JlcXVlc3RBbmltYXRpb25GcmFtZVwiO1xuaW1wb3J0IHtEZWJ1Z30gICAgICAgICAgICAgICAgICAgICAgICBmcm9tIFwiYXdheWpzLWNvcmUvbGliL3V0aWxzL0RlYnVnXCI7XG5cbmltcG9ydCB7Vmlld30gICAgICAgICAgICAgICAgICAgICAgICAgZnJvbSBcImF3YXlqcy1kaXNwbGF5L2xpYi9WaWV3XCI7XG5pbXBvcnQge1Nwcml0ZX0gICAgICAgICAgICAgICAgICAgICAgIGZyb20gXCJhd2F5anMtZGlzcGxheS9saWIvZGlzcGxheS9TcHJpdGVcIjtcbmltcG9ydCB7UHJpbWl0aXZlUGxhbmVQcmVmYWJ9ICAgICAgICAgZnJvbSBcImF3YXlqcy1kaXNwbGF5L2xpYi9wcmVmYWJzL1ByaW1pdGl2ZVBsYW5lUHJlZmFiXCI7XG5cbmltcG9ydCB7RGVmYXVsdFJlbmRlcmVyfSAgICAgICAgICAgICAgZnJvbSBcImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9EZWZhdWx0UmVuZGVyZXJcIjtcblxuaW1wb3J0IHtCYXNpY01hdGVyaWFsfSAgICAgICAgICAgICAgICBmcm9tIFwiYXdheWpzLWRpc3BsYXkvbGliL21hdGVyaWFscy9CYXNpY01hdGVyaWFsXCI7XG5pbXBvcnQge1VSTExvYWRlcn1cdFx0XHRcdFx0ZnJvbSBcImF3YXlqcy1jb3JlL2xpYi9uZXQvVVJMTG9hZGVyXCI7XG5pbXBvcnQge1VSTExvYWRlckRhdGFGb3JtYXR9XHRcdFx0ZnJvbSBcImF3YXlqcy1jb3JlL2xpYi9uZXQvVVJMTG9hZGVyRGF0YUZvcm1hdFwiO1xuaW1wb3J0IHtVUkxSZXF1ZXN0fVx0XHRcdFx0XHRmcm9tIFwiYXdheWpzLWNvcmUvbGliL25ldC9VUkxSZXF1ZXN0XCI7XG5pbXBvcnQge1BhcnNlclV0aWxzfVx0XHRcdFx0XHRmcm9tIFwiYXdheWpzLWNvcmUvbGliL3BhcnNlcnMvUGFyc2VyVXRpbHNcIjtcbmltcG9ydCB7RWxlbWVudHNUeXBlfSAgICAgICAgICAgICAgICAgZnJvbSBcImF3YXlqcy1kaXNwbGF5L2xpYi9ncmFwaGljcy9FbGVtZW50c1R5cGVcIjtcblxuY2xhc3MgTWlwTWFwU29mdHdhcmVUZXN0IHtcblxuXHRwcml2YXRlIHZpZXc6Vmlldztcblx0cHJpdmF0ZSByYWY6UmVxdWVzdEFuaW1hdGlvbkZyYW1lO1xuXHRwcml2YXRlIHBuZ0xvYWRlciAgIDogVVJMTG9hZGVyO1xuXHRwcml2YXRlIGltYWdlOkhUTUxJbWFnZUVsZW1lbnQ7XG5cblx0Y29uc3RydWN0b3IoKSB7XG5cblx0XHR2YXIgcG5nVVJMUmVxdWVzdDpVUkxSZXF1ZXN0ID0gbmV3IFVSTFJlcXVlc3QoJ2Fzc2V0cy9kb3RzLnBuZycpO1xuXG5cdFx0dGhpcy5wbmdMb2FkZXIgPSBuZXcgVVJMTG9hZGVyKCk7XG5cdFx0dGhpcy5wbmdMb2FkZXIuZGF0YUZvcm1hdCA9IFVSTExvYWRlckRhdGFGb3JtYXQuQkxPQjtcblx0XHR0aGlzLnBuZ0xvYWRlci5hZGRFdmVudExpc3RlbmVyKFVSTExvYWRlckV2ZW50LkxPQURfQ09NUExFVEUsIChldmVudDpVUkxMb2FkZXJFdmVudCkgPT4gdGhpcy5wbmdMb2FkZXJDb21wbGV0ZShldmVudCkpO1xuXHRcdHRoaXMucG5nTG9hZGVyLmxvYWQocG5nVVJMUmVxdWVzdCk7XG5cdH1cblxuXHRwcml2YXRlIHBuZ0xvYWRlckNvbXBsZXRlKGV2ZW50OlVSTExvYWRlckV2ZW50KSB7XG5cdFx0dmFyIGltYWdlTG9hZGVyOlVSTExvYWRlciA9IGV2ZW50LnRhcmdldDtcblx0XHR0aGlzLmltYWdlID0gUGFyc2VyVXRpbHMuYmxvYlRvSW1hZ2UoaW1hZ2VMb2FkZXIuZGF0YSk7XG5cdFx0dGhpcy5pbWFnZS5vbmxvYWQgPSAoZXZlbnQpID0+IHRoaXMub25Mb2FkQ29tcGxldGUoZXZlbnQpO1xuXHR9XG5cblx0cHJpdmF0ZSBvbkxvYWRDb21wbGV0ZShldmVudCkge1xuXHRcdERlYnVnLkxPR19QSV9FUlJPUlMgPSBmYWxzZTtcblx0XHREZWJ1Zy5USFJPV19FUlJPUlMgPSBmYWxzZTtcblxuXHRcdHZhciBkZWZhdWx0UmVuZGVyZXI6RGVmYXVsdFJlbmRlcmVyID0gbmV3IERlZmF1bHRSZW5kZXJlcihudWxsLCBmYWxzZSwgXCJiYXNlbGluZVwiLCBcInNvZnR3YXJlXCIpO1xuXHRcdGRlZmF1bHRSZW5kZXJlci5hbnRpQWxpYXMgPSAyO1xuXHRcdHRoaXMudmlldyA9IG5ldyBWaWV3KGRlZmF1bHRSZW5kZXJlcik7XG5cdFx0Ly90aGlzLnZpZXcgPSBuZXcgVmlldyhuZXcgRGVmYXVsdFJlbmRlcmVyKG51bGwsIGZhbHNlLCBcImJhc2VsaW5lXCIpKTtcblx0XHR0aGlzLnJhZiA9IG5ldyBSZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5yZW5kZXIsIHRoaXMpO1xuXG5cdFx0dGhpcy52aWV3LmJhY2tncm91bmRDb2xvciA9IDB4MjIyMjIyO1xuXG5cdFx0d2luZG93Lm9ucmVzaXplID0gKGV2ZW50OlVJRXZlbnQpID0+IHRoaXMub25SZXNpemUoZXZlbnQpO1xuXG5cdFx0dGhpcy5pbml0U3ByaXRlZXMoKTtcblx0XHR0aGlzLnJhZi5zdGFydCgpO1xuXHRcdHRoaXMub25SZXNpemUoKTtcblx0fVxuXG5cdHByaXZhdGUgaW5pdFNwcml0ZWVzKCk6dm9pZCB7XG5cdFx0Ly92YXIgbWF0ZXJpYWw6QmFzaWNNYXRlcmlhbCA9IG5ldyBCYXNpY01hdGVyaWFsKERlZmF1bHRNYXRlcmlhbE1hbmFnZXIuZ2V0RGVmYXVsdFRleHR1cmUoKSk7XG5cdFx0dmFyIG1hdGVyaWFsOkJhc2ljTWF0ZXJpYWwgPSBuZXcgQmFzaWNNYXRlcmlhbChQYXJzZXJVdGlscy5pbWFnZVRvQml0bWFwSW1hZ2UyRCh0aGlzLmltYWdlKSk7XG5cdFx0bWF0ZXJpYWwuc3R5bGUuc2FtcGxlciA9IG5ldyBTYW1wbGVyMkQodHJ1ZSwgdHJ1ZSwgdHJ1ZSk7XG5cdFx0dmFyIHBsYW5lOlByaW1pdGl2ZVBsYW5lUHJlZmFiID0gbmV3IFByaW1pdGl2ZVBsYW5lUHJlZmFiKG1hdGVyaWFsLCBFbGVtZW50c1R5cGUuVFJJQU5HTEUsIDEwMDAsMTAwMCwxMDAwKTtcblx0XHQvL3ZhciBwbGFuZTpQcmltaXRpdmVDdWJlUHJlZmFiID0gbmV3IFByaW1pdGl2ZUN1YmVQcmVmYWIoKTtcblx0XHRwbGFuZS5tYXRlcmlhbCA9IG1hdGVyaWFsO1xuXG5cdFx0dmFyIHNwcml0ZTpTcHJpdGUgPSA8U3ByaXRlPnBsYW5lLmdldE5ld09iamVjdCgpO1xuXHRcdHNwcml0ZS55ID0gLTEwMDtcblx0XHR0aGlzLnZpZXcuc2NlbmUuYWRkQ2hpbGQoc3ByaXRlKTtcblx0fVxuXG5cdHByaXZhdGUgYzpudW1iZXIgPSAxMDA7XG5cblx0cHJpdmF0ZSByZW5kZXIoKSB7XG5cdFx0aWYgKHRoaXMuYyA+IDEwKSB7XG5cdFx0XHR0aGlzLmMgPSAwO1xuXHRcdFx0dGhpcy52aWV3LnJlbmRlcigpO1xuXHRcdH1cblx0XHR0aGlzLmMrKztcblx0fVxuXG5cdHB1YmxpYyBvblJlc2l6ZShldmVudDpVSUV2ZW50ID0gbnVsbCkge1xuXHRcdHRoaXMudmlldy55ID0gMDtcblx0XHR0aGlzLnZpZXcueCA9IDA7XG5cblx0XHR0aGlzLnZpZXcud2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcblx0XHR0aGlzLnZpZXcuaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xuXHR9XG59Il0sInNvdXJjZVJvb3QiOiIuL3Rlc3RzIn0=
