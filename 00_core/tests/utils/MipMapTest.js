"use strict";
var BitmapImage2D_1 = require("awayjs-core/lib/image/BitmapImage2D");
var Matrix_1 = require("awayjs-core/lib/geom/Matrix");
var Rectangle_1 = require("awayjs-core/lib/geom/Rectangle");
var URLLoader_1 = require("awayjs-core/lib/net/URLLoader");
var URLLoaderDataFormat_1 = require("awayjs-core/lib/net/URLLoaderDataFormat");
var URLRequest_1 = require("awayjs-core/lib/net/URLRequest");
var URLLoaderEvent_1 = require("awayjs-core/lib/events/URLLoaderEvent");
var ParserUtils_1 = require("awayjs-core/lib/parsers/ParserUtils");
var ImageUtils_1 = require("awayjs-core/lib/utils/ImageUtils");
var MipMapTest = (function () {
    function MipMapTest() {
        //---------------------------------------
        // Load a PNG
        var _this = this;
        this._rect = new Rectangle_1.default();
        this._matrix = new Matrix_1.default();
        var mipUrlRequest = new URLRequest_1.default('assets/1024x1024.png');
        this.mipLoader = new URLLoader_1.default();
        this.mipLoader.dataFormat = URLLoaderDataFormat_1.default.BLOB;
        this.mipLoader.load(mipUrlRequest);
        this.mipLoader.addEventListener(URLLoaderEvent_1.default.LOAD_COMPLETE, function (event) { return _this.mipImgLoaded(event); });
        document.onmousedown = function (e) { return _this.onMouseDown(e); };
    }
    MipMapTest.prototype.mipImgLoaded = function (event) {
        var _this = this;
        var loader = event.target;
        var image = ParserUtils_1.default.blobToImage(loader.data);
        image.onload = function (event) { return _this.onImageLoad(event); };
    };
    MipMapTest.prototype.onImageLoad = function (event) {
        var image = event.target;
        alert('Each click will generate a level of MipMap');
        this.sourceBitmap = new BitmapImage2D_1.default(1024, 1024, true, 0xff0000);
        this.sourceBitmap.draw(image);
        this.sourceBitmap.getCanvas().style.position = 'absolute';
        this.sourceBitmap.getCanvas().style.left = '0px';
        this.sourceBitmap.getCanvas().style.top = '1030px';
        //document.body.appendChild( this.sourceBitmap.canvas );
        this.mipMap = new BitmapImage2D_1.default(1024, 1024, true, 0xff0000);
        this.mipMap.getCanvas().style.position = 'absolute';
        this.mipMap.getCanvas().style.left = '0px';
        this.mipMap.getCanvas().style.top = '0px';
        document.body.appendChild(this.mipMap.getCanvas());
        this._rect.width = this.sourceBitmap.width;
        this._rect.height = this.sourceBitmap.height;
        this.w = this.sourceBitmap.width;
        this.h = this.sourceBitmap.height;
    };
    MipMapTest.prototype.onMouseDown = function (e) {
        this.generateMipMap(this.sourceBitmap, this.mipMap);
    };
    MipMapTest.prototype.generateMipMap = function (source, mipmap, alpha, side) {
        if (mipmap === void 0) { mipmap = null; }
        if (alpha === void 0) { alpha = false; }
        if (side === void 0) { side = -1; }
        var c = this.w;
        var i;
        console['time']('MipMap' + c);
        if ((this.w >= 1) || (this.h >= 1)) {
            if (alpha)
                mipmap.fillRect(this._rect, 0);
            this._matrix.a = this._rect.width / source.width;
            this._matrix.d = this._rect.height / source.height;
            mipmap.width = this.w;
            mipmap.height = this.h;
            mipmap.copyPixels(source, source.rect, new Rectangle_1.default(0, 0, this.w, this.h));
            this.w >>= 1;
            this.h >>= 1;
            this._rect.width = this.w > 1 ? this.w : 1;
            this._rect.height = this.h > 1 ? this.h : 1;
        }
        console.log('ImageUtils.isBitmapImage2DValid: ', ImageUtils_1.default.isImage2DValid(mipmap));
        console['timeEnd']('MipMap' + c);
    };
    return MipMapTest;
}());

//# sourceMappingURL=data:application/json;base64,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QUMsU0FBUyxDQUFDLENBQUMsUUFBUSxHQUFHLENBQUMsQ0FBQyxDQUFDO0lBRWxDLENBQUM7SUFDRixpQkFBQztBQUFELENBaEdBLEFBZ0dDLElBQUEiLCJmaWxlIjoidXRpbHMvTWlwTWFwVGVzdC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBCaXRtYXBJbWFnZTJEXHRcdGZyb20gXCJhd2F5anMtY29yZS9saWIvaW1hZ2UvQml0bWFwSW1hZ2UyRFwiO1xuaW1wb3J0IE1hdHJpeFx0XHRcdFx0ZnJvbSBcImF3YXlqcy1jb3JlL2xpYi9nZW9tL01hdHJpeFwiO1xuaW1wb3J0IFJlY3RhbmdsZVx0XHRcdGZyb20gXCJhd2F5anMtY29yZS9saWIvZ2VvbS9SZWN0YW5nbGVcIjtcbmltcG9ydCBVUkxMb2FkZXJcdFx0XHRmcm9tIFwiYXdheWpzLWNvcmUvbGliL25ldC9VUkxMb2FkZXJcIjtcbmltcG9ydCBVUkxMb2FkZXJEYXRhRm9ybWF0XHRmcm9tIFwiYXdheWpzLWNvcmUvbGliL25ldC9VUkxMb2FkZXJEYXRhRm9ybWF0XCI7XG5pbXBvcnQgVVJMUmVxdWVzdFx0XHRcdGZyb20gXCJhd2F5anMtY29yZS9saWIvbmV0L1VSTFJlcXVlc3RcIjtcbmltcG9ydCBVUkxMb2FkZXJFdmVudFx0XHRmcm9tIFwiYXdheWpzLWNvcmUvbGliL2V2ZW50cy9VUkxMb2FkZXJFdmVudFwiO1xuaW1wb3J0IFBhcnNlclV0aWxzXHRcdFx0ZnJvbSBcImF3YXlqcy1jb3JlL2xpYi9wYXJzZXJzL1BhcnNlclV0aWxzXCI7XG5pbXBvcnQgSW1hZ2VVdGlsc1x0XHRcdGZyb20gXCJhd2F5anMtY29yZS9saWIvdXRpbHMvSW1hZ2VVdGlsc1wiO1xuXG5jbGFzcyBNaXBNYXBUZXN0XG57XG5cblx0cHJpdmF0ZSBtaXBMb2FkZXIgICAgICAgOiBVUkxMb2FkZXI7XG5cdHByaXZhdGUgc291cmNlQml0bWFwICAgIDogQml0bWFwSW1hZ2UyRDtcblx0cHJpdmF0ZSBtaXBNYXAgICAgICAgICAgOiBCaXRtYXBJbWFnZTJEO1xuXHRwcml2YXRlIF9yZWN0ICAgICAgICAgICA6IFJlY3RhbmdsZSA9IG5ldyBSZWN0YW5nbGUoKTtcblx0cHJpdmF0ZSBfbWF0cml4ICAgICAgICAgOiBNYXRyaXggPSBuZXcgTWF0cml4KCk7XG5cdHByaXZhdGUgdyAgICAgICAgICAgICAgIDogbnVtYmVyO1xuXHRwcml2YXRlIGggICAgICAgICAgICAgICA6IG51bWJlcjtcblxuXHRjb25zdHJ1Y3RvcigpXG5cdHtcblx0XHQvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdC8vIExvYWQgYSBQTkdcblxuXHRcdHZhciBtaXBVcmxSZXF1ZXN0ID0gbmV3IFVSTFJlcXVlc3QoICdhc3NldHMvMTAyNHgxMDI0LnBuZycpO1xuXHRcdHRoaXMubWlwTG9hZGVyICA9IG5ldyBVUkxMb2FkZXIoKTtcblx0XHR0aGlzLm1pcExvYWRlci5kYXRhRm9ybWF0ID0gVVJMTG9hZGVyRGF0YUZvcm1hdC5CTE9CO1xuXHRcdHRoaXMubWlwTG9hZGVyLmxvYWQoIG1pcFVybFJlcXVlc3QgKTtcblx0XHR0aGlzLm1pcExvYWRlci5hZGRFdmVudExpc3RlbmVyKCBVUkxMb2FkZXJFdmVudC5MT0FEX0NPTVBMRVRFICwgKGV2ZW50OlVSTExvYWRlckV2ZW50KSA9PiB0aGlzLm1pcEltZ0xvYWRlZChldmVudCkgKTtcblxuXHRcdGRvY3VtZW50Lm9ubW91c2Vkb3duID0gKCBlICkgPT4gdGhpcy5vbk1vdXNlRG93biggZSApO1xuXHR9XG5cblx0cHJpdmF0ZSBtaXBJbWdMb2FkZWQoZXZlbnQ6VVJMTG9hZGVyRXZlbnQpXG5cdHtcblx0XHR2YXIgbG9hZGVyICA6IFVSTExvYWRlciAgICAgICAgPSA8VVJMTG9hZGVyID4gZXZlbnQudGFyZ2V0O1xuXHRcdHZhciBpbWFnZSA6IEhUTUxJbWFnZUVsZW1lbnQgPSBQYXJzZXJVdGlscy5ibG9iVG9JbWFnZShsb2FkZXIuZGF0YSk7XG5cdFx0aW1hZ2Uub25sb2FkID0gKCBldmVudCApID0+IHRoaXMub25JbWFnZUxvYWQoIGV2ZW50ICk7XG5cdH1cblxuXHRwcml2YXRlIG9uSW1hZ2VMb2FkIChldmVudClcblx0e1xuXHRcdHZhciBpbWFnZSA6IEhUTUxJbWFnZUVsZW1lbnQgPSA8SFRNTEltYWdlRWxlbWVudD4gZXZlbnQudGFyZ2V0O1xuXHRcdGFsZXJ0KCAnRWFjaCBjbGljayB3aWxsIGdlbmVyYXRlIGEgbGV2ZWwgb2YgTWlwTWFwJyk7XG5cblx0XHR0aGlzLnNvdXJjZUJpdG1hcCAgICAgICAgICAgICAgICAgICAgICAgID0gbmV3IEJpdG1hcEltYWdlMkQoIDEwMjQgLCAxMDI0ICwgdHJ1ZSAsIDB4ZmYwMDAwICk7XG5cdFx0dGhpcy5zb3VyY2VCaXRtYXAuZHJhdyhpbWFnZSk7XG5cdFx0dGhpcy5zb3VyY2VCaXRtYXAuZ2V0Q2FudmFzKCkuc3R5bGUucG9zaXRpb24gID0gJ2Fic29sdXRlJztcblx0XHR0aGlzLnNvdXJjZUJpdG1hcC5nZXRDYW52YXMoKS5zdHlsZS5sZWZ0ICAgICAgPSAnMHB4Jztcblx0XHR0aGlzLnNvdXJjZUJpdG1hcC5nZXRDYW52YXMoKS5zdHlsZS50b3AgICAgICAgPSAnMTAzMHB4JztcblxuXHRcdC8vZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCggdGhpcy5zb3VyY2VCaXRtYXAuY2FudmFzICk7XG5cblx0XHR0aGlzLm1pcE1hcCA9IG5ldyBCaXRtYXBJbWFnZTJEKCAxMDI0ICwgMTAyNCAsIHRydWUgLCAweGZmMDAwMCApO1xuXHRcdHRoaXMubWlwTWFwLmdldENhbnZhcygpLnN0eWxlLnBvc2l0aW9uICA9ICdhYnNvbHV0ZSc7XG5cdFx0dGhpcy5taXBNYXAuZ2V0Q2FudmFzKCkuc3R5bGUubGVmdCAgICAgID0gJzBweCc7XG5cdFx0dGhpcy5taXBNYXAuZ2V0Q2FudmFzKCkuc3R5bGUudG9wICAgICAgID0gJzBweCc7XG5cblx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKCB0aGlzLm1pcE1hcC5nZXRDYW52YXMoKSApO1xuXG5cdFx0dGhpcy5fcmVjdC53aWR0aCAgICA9IHRoaXMuc291cmNlQml0bWFwLndpZHRoO1xuXHRcdHRoaXMuX3JlY3QuaGVpZ2h0ICAgPSB0aGlzLnNvdXJjZUJpdG1hcC5oZWlnaHQ7XG5cblx0XHR0aGlzLncgPSB0aGlzLnNvdXJjZUJpdG1hcC53aWR0aDtcblx0XHR0aGlzLmggPSB0aGlzLnNvdXJjZUJpdG1hcC5oZWlnaHQ7XG5cblx0fVxuXG5cdHByaXZhdGUgb25Nb3VzZURvd24oIGUgKVxuXHR7XG5cdFx0dGhpcy5nZW5lcmF0ZU1pcE1hcCggdGhpcy5zb3VyY2VCaXRtYXAgLCAgdGhpcy5taXBNYXAgKTtcblx0fVxuXHRcblx0cHVibGljIGdlbmVyYXRlTWlwTWFwKCBzb3VyY2UgOiBCaXRtYXBJbWFnZTJEICwgbWlwbWFwIDogQml0bWFwSW1hZ2UyRCA9IG51bGwsIGFscGhhOmJvb2xlYW4gPSBmYWxzZSwgc2lkZTpudW1iZXIgPSAtMSlcblx0e1xuXHRcdHZhciBjOm51bWJlciA9IHRoaXMudztcblx0XHR2YXIgaTpudW1iZXI7XG5cblx0XHRjb25zb2xlWyd0aW1lJ10oJ01pcE1hcCcgKyBjKTtcblx0XHRcblx0XHRpZiAoKHRoaXMudyA+PSAxICkgfHwgKHRoaXMuaCA+PSAxKSkge1xuXG5cdFx0XHRpZiAoYWxwaGEpXG5cdFx0XHRcdG1pcG1hcC5maWxsUmVjdCh0aGlzLl9yZWN0LCAwKTtcblxuXHRcdFx0dGhpcy5fbWF0cml4LmEgPSB0aGlzLl9yZWN0LndpZHRoIC8gc291cmNlLndpZHRoO1xuXHRcdFx0dGhpcy5fbWF0cml4LmQgPSB0aGlzLl9yZWN0LmhlaWdodCAvIHNvdXJjZS5oZWlnaHQ7XG5cblx0XHRcdG1pcG1hcC53aWR0aCA9IHRoaXMudztcblx0XHRcdG1pcG1hcC5oZWlnaHQ9IHRoaXMuaDtcblx0XHRcdG1pcG1hcC5jb3B5UGl4ZWxzKCBzb3VyY2UgLCBzb3VyY2UucmVjdCAsIG5ldyBSZWN0YW5nbGUoIDAgLCAwICwgdGhpcy53ICwgdGhpcy5oICkgKTtcblxuXHRcdFx0dGhpcy53ID4+PSAxO1xuXHRcdFx0dGhpcy5oID4+PSAxO1xuXG5cdFx0XHR0aGlzLl9yZWN0LndpZHRoID0gdGhpcy53ID4gMT8gdGhpcy53IDogMTtcblx0XHRcdHRoaXMuX3JlY3QuaGVpZ2h0ID0gdGhpcy5oID4gMT8gdGhpcy5oIDogMTtcblx0XHR9XG5cblx0XHRjb25zb2xlLmxvZyggJ0ltYWdlVXRpbHMuaXNCaXRtYXBJbWFnZTJEVmFsaWQ6ICcgLCBJbWFnZVV0aWxzLmlzSW1hZ2UyRFZhbGlkKCBtaXBtYXAgKSk7XG5cblx0XHRjb25zb2xlWyd0aW1lRW5kJ10oJ01pcE1hcCcgKyBjKTtcblxuXHR9XG59Il0sInNvdXJjZVJvb3QiOiIuL3Rlc3RzIn0=
